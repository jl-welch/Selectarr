!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).selectarr=t()}(this,function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c="selectarr",o="data-selectarr",u="data-selectarr-list",h="data-selectarr-item",d="data-selectarr-value",r="selectarr-active",e=function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"[".concat(o,"]"),t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[{}];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.init=this.init.bind(this),this.search=this.search.bind(this),this.createList=this.createList.bind(this),this.changeActive=this.changeActive.bind(this),this.key=this.key.bind(this),this.keyEnter=this.keyEnter.bind(this),this.keyArrowUp=this.keyArrowUp.bind(this),this.keyArrowDown=this.keyArrowDown.bind(this),this.mouseEnter=this.mouseEnter.bind(this),this._element=document.querySelector(e),this._data=t,this._index=-1,this._element&&this.init()}var e,t,n;return e=s,n=[{key:"applyValue",value:function(e){var t,n,i,r,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if((t="key"in e?e.target.parentElement.querySelector("[".concat(u,"]")):e.target.closest("[".concat(u,"]")))&&(n=e.target.closest("[".concat(h,"]"))||t.querySelector("[".concat(h,'="').concat(a,'"]'))),n){var l=t.parentElement;i=l.querySelector("[".concat(o,"]")),r=l.querySelector(".".concat(c)),i&&r&&(i.value=n.textContent,r.value=n.getAttribute(d))}s.remove()}},{key:"remove",value:function(){var e=document.querySelector("[".concat(u,"]"));e&&e.parentElement.removeChild(e)}}],(t=[{key:"init",value:function(){var e=this._element.cloneNode(),t=e.cloneNode(),n=this._element.parentElement;e.removeAttribute("name"),e.addEventListener("keyup",this.search),t.className=c,t.type="hidden",t.removeAttribute(o),this._parent=document.createElement("div"),this._parent.style.display="inline-block",this._parent.style.position="relative",this._parent.appendChild(e),this._parent.appendChild(t),n.replaceChild(this._parent,this._element),this._element=e}},{key:"search",value:function(e){var t=e.key;if("ArrowUp"===t||"ArrowDown"===t||"Enter"===t)this.key(e,e.key);else{if(s.remove(),this._index=-1,!this._element.value.length)return null;var n=new RegExp(this._element.value,"gi"),i=this._data.filter(function(e){return e.text.match(n)});i.length&&this.createList(i)}}},{key:"createList",value:function(e){var n,i=this,r=document.createElement("ul");r.setAttribute(u,""),e.forEach(function(e,t){(n=document.createElement("li")).setAttribute(d,e.value),n.setAttribute(h,t),n.textContent=e.text,n.addEventListener("mouseenter",i.hover),r.appendChild(n)}),this._parent.appendChild(r)}},{key:"changeActive",value:function(){var e=document.querySelectorAll("[".concat(h,"]"));if(!e.length)return null;var t=document.querySelector(".".concat(r));t&&(t.className=""),e[this._index].className=r}},{key:"key",value:function(e,t){var n=document.querySelectorAll("[".concat(h,"]"));if(!n.length)return null;this["key".concat(t)](e,n)}},{key:"keyEnter",value:function(e){if(-1===this._index)return null;s.applyValue(e,this._index),this._index=-1}},{key:"keyArrowUp",value:function(){if(0===this._index||-1===this._index)return null;this._index--,this.changeActive()}},{key:"keyArrowDown",value:function(e,t){if(this._index===t.length-1)return null;this._index++,this.changeActive()}},{key:"mouseEnter",value:function(e){var t=e.target.closest("[".concat(h,"]"));if(!t)return null;this._index=parseInt(t.getAttribute(h),10),this.changeActive()}}])&&i(e.prototype,t),n&&i(e,n),s}();return document.addEventListener("click",e.applyValue),new e(".test",[{text:"one",value:0},{text:"two",value:1},{text:"three",value:2}]),new e(".testt",[{text:"one",value:0},{text:"two",value:1},{text:"three",value:2}]),e});