!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).selectarr=t()}(this,function(){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o="data-selectarr",h="data-selectarr-list",u="data-selectarr-item",d="data-selectarr-value",v="-input",s="-list",r="-item",a="-active",e=function(){function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"[".concat(o,"]"),t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.init=this.init.bind(this),this.search=this.search.bind(this),this.createList=this.createList.bind(this),this.changeActive=this.changeActive.bind(this),this.key=this.key.bind(this),this.keyEnter=this.keyEnter.bind(this),this.keyArrowUp=this.keyArrowUp.bind(this),this.keyArrowDown=this.keyArrowDown.bind(this),this.mouseEnter=this.mouseEnter.bind(this),this._element=document.querySelector(e),this._class="class"in t?t.class:"selectarr",this._data=t,this._index=-1,this._element&&"values"in t&&this.init()}var e,t,n;return e=l,n=[{key:"applyValue",value:function(e){var t,n,i,a,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if((t="key"in e?e.target.parentElement.querySelector("[".concat(h,"]")):e.target.closest("[".concat(h,"]")))&&(n=e.target.closest("[".concat(u,"]"))||t.querySelector("[".concat(u,'="').concat(s,'"]'))),n){var r=t.parentElement,c=r.className;i=r.querySelector("[".concat(o,"]")),a=r.querySelector(".".concat(c).concat(v)),i&&a&&(i.value=n.textContent,a.value=n.getAttribute(d))}l.remove()}},{key:"remove",value:function(){var e=document.querySelector("[".concat(h,"]"));e&&e.parentElement.removeChild(e)}}],(t=[{key:"init",value:function(){var e=this._element.cloneNode(),t=this._element.parentElement;this._element.removeAttribute("name"),this._element.addEventListener("keyup",this.search),e.className="".concat(this._class).concat(v),e.type="hidden",e.removeAttribute("id"),e.removeAttribute(o),this._parent=document.createElement("div"),this._parent.className=this._class,t.replaceChild(this._parent,this._element),this._parent.appendChild(this._element),this._parent.appendChild(e)}},{key:"search",value:function(e){var t=e.key;if("ArrowUp"===t||"ArrowDown"===t||"Enter"===t)this.key(e,e.key);else{if(l.remove(),this._index=-1,!this._element.value.length)return null;var n=new RegExp(this._element.value,"gi"),i=this._data.values.filter(function(e){return e.hasOwnProperty("text")&&e.text.match(n)});i.length&&this.createList(i)}}},{key:"createList",value:function(e){var n,i=this,a=document.createElement("ul");a.className="".concat(this._class).concat(s),a.setAttribute(h,""),e.forEach(function(e,t){(n=document.createElement("li")).textContent=e.text,n.className="".concat(i._class).concat(r),n.setAttribute(d,e.value||e.text),n.setAttribute(u,t),n.addEventListener("mouseenter",i.mouseEnter),a.appendChild(n)}),this._parent.appendChild(a)}},{key:"changeActive",value:function(){var e=document.querySelectorAll("[".concat(u,"]"));if(!e.length)return null;var t=document.querySelector(".".concat(this._class).concat(a));t&&t.classList.remove(this._class+a),e[this._index].classList.add(this._class+a)}},{key:"key",value:function(e,t){var n=document.querySelectorAll("[".concat(u,"]"));if(!n.length)return null;this["key".concat(t)](e,n)}},{key:"keyEnter",value:function(e){if(-1===this._index)return null;l.applyValue(e,this._index),this._index=-1}},{key:"keyArrowUp",value:function(){if(0===this._index||-1===this._index)return null;this._index--,this.changeActive()}},{key:"keyArrowDown",value:function(e,t){if(this._index===t.length-1)return null;this._index++,this.changeActive()}},{key:"mouseEnter",value:function(e){var t=e.target.closest("[".concat(u,"]"));if(!t)return null;this._index=parseInt(t.getAttribute(u),10),this.changeActive()}}])&&i(e.prototype,t),n&&i(e,n),l}();return document.addEventListener("click",e.applyValue),new e(".test",{values:[{text:"hello",value:"hi"}]}),e});