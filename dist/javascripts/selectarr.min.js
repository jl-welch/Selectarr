!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).selectarr=t()}(this,function(){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a="data-selectarr",l="data-selectarr-list",r="data-selectarr-item",c="data-selectarr-value",h="-input",u="-list",o="open",_="-item",d="-active",e=function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"[".concat(a,"]"),t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this._search=this._search.bind(this),this._applyValue=this._applyValue.bind(this),this._element=document.querySelector(e),this._list=document.createElement("ul"),this._hidden=null,this._wrapper=null,this._length=null,this._data=t,this._index=-1,this._limit=this.setLimit(),this._class="class"in t?t.class:"selectarr",!this._element||!this._data.values)return null;this.init()}var e,t,i;return e=s,i=[{key:"_checkSibling",value:function(e){return e?e.parentElement.querySelector("[".concat(l,"].").concat(o)):null}},{key:"_removeList",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;if(e){var t=e.target.closest("[".concat(a,"]"));if(s._checkSibling(t))return null}var i=document.querySelector("[".concat(l,"].").concat(o));i&&(i.classList.remove(o),i.innerHTML="")}}],(t=[{key:"init",value:function(){var e=this._element.parentElement;this._hidden=document.createElement("input"),this._hidden.className="".concat(this._class).concat(h),this._hidden.name=this._element.name,this._hidden.type="hidden",this._element.removeAttribute("name"),this._element.addEventListener("keyup",this._search),this._list.addEventListener("click",this._applyValue),this._list.className=this._class+u,this._list.setAttribute(l,""),this._wrapper=document.createElement("div"),this._wrapper.className=this._class,e.replaceChild(this._wrapper,this._element),this._wrapper.appendChild(this._element),this._wrapper.appendChild(this._hidden),this._wrapper.appendChild(this._list)}},{key:"addActive",value:function(){this.removeActive();var e=this._list.querySelectorAll("[".concat(r,"]"));if(!e.length||this._index<0||this._index>e.length)return null;e[this._index].classList.add(this._class+d)}},{key:"removeActive",value:function(){var e=this._list.querySelector(".".concat(this._class).concat(d));e&&e.classList.remove(this._class+d)}},{key:"setLimit",value:function(e){var t=e||this._data.limit;return t&&0<+t?+t:10}},{key:"_applyValue",value:function(e){var t=e.target.closest("[".concat(r,"]"))||this._list.querySelector("[".concat(r,'="').concat(this._index,'"]'));if(!t)return null;this._element.value=t.textContent,this._hidden.value=t.getAttribute(c),s._removeList()}},{key:"_populateList",value:function(e){var i,n=this;this._length=e.length-1,e.forEach(function(e,t){(i=document.createElement("li")).textContent=e.text,i.className="".concat(n._class).concat(_),i.setAttribute(c,e.value||e.text),i.setAttribute(r,t),i.addEventListener("mouseenter",n._mouseEnter),n._list.appendChild(i),n._list.classList.add(o)})}},{key:"_match",value:function(t){return this._data.values.filter(function(e){return e.hasOwnProperty("text")&&e.text.match(t)}).sort(function(e,t){return e.text.localeCompare(t.text)})}},{key:"_search",value:function(e){var t=e.key;if("ArrowUp"===t||"ArrowDown"===t||"Enter"===t)return this._key(e,e.key);if(s._removeList(),this._index=-1,!this._element.value.length)return null;var i=new RegExp(this._element.value,"gi"),n=this._match(i).slice(0,this._limit);n.length&&this._populateList(n)}},{key:"_key",value:function(e){this["_key".concat(e.key)](e),"Enter"!==e.key&&this.addActive()}},{key:"_keyArrowUp",value:function(){0<this._index&&this._index--}},{key:"_keyArrowDown",value:function(){this._index<this._length&&this._index++}},{key:"_keyEnter",value:function(e){if(-1===this._index)return null;this._applyValue(e,this._index),this._index=-1}},{key:"_mouseEnter",value:function(e){var t=e.target.closest("[".concat(r,"]"));t&&(this._index=parseInt(t.getAttribute(r),10))}}])&&n(e.prototype,t),i&&n(e,i),s}();new e(".test",{limit:5,class:"hello",values:[{text:"howdy",value:"1"},{text:"hello",value:"1"},{text:"hola",value:"1"},{text:"hi",value:"1"},{text:"labas",value:"1"},{text:"bonjous",value:"1"},{text:"priviet",value:"1"},{text:"sveiki",value:"1"}]});return document.addEventListener("click",e._removeList),e});